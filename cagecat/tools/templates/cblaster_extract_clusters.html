{% extends "base.html" %}
{% from "macros.html" import filtering_section %}
{% from "macros.html" import showNavigationBar %}
{% from "macros.html" import renderHelpButton %}
{% from "macros.html" import showSelectedClusters %}
{% from 'macros.html' import renderJobDetailsInput %}
{% from 'macros.html' import showRequiredInputsText %}

{% block navigationBar %}
    {{ showNavigationBar('analyze') }}
{% endblock %}

{% block content %}
    <h2 class="indent">Extract clusters</h2>
    {{  showRequiredInputsText() }}

<form action="{{url_for('submit_job')}}" method="post">

    <input type="hidden" name="job_type" value="extract_clusters"/>
    <input type="hidden" name="prev_job_id" value="{{prev_job_id}}"/>

    {{ renderJobDetailsInput() }}

    {{ filtering_section('clusters', selected_scaffolds, cluster_numbers) }}

    <label class="fieldset-label" for="outputSectionExtractClusters">Output</label>
    <fieldset id="outputSectionExtractClusters">
        <div class="input-layer">
            <label class="input-label" for="prefix">Prefix</label>
            {{ renderHelpButton('prefix') }}
            <input class="custom-width" type="text" id="prefix" name="prefix" maxlength="15"/>
        </div>
        <div class="input-layer">
            <label class="select-label" for="format">Format*</label>
            <select class="custom-width" name="format" id="format" required="required">
                <option value="genbank">GenBank</option>
                <option value="bigscape">BiG-SCAPE</option>
            </select>
            {{ renderHelpButton('format') }}
        </div>
        <div class="input-layer">
            <label class="input-label" for="maxclusters">Maximum clusters*</label>
            {{ renderHelpButton('maxclusters') }}
            <input class="short" type="number" name="maxclusters" value="50" step="1" min="1" max="{{ max_clusters_to_extract }}" id="maxclusters" required="required"/>
        </div>
    </fieldset>

    {{ showSelectedClusters(cluster_headers, True, False) }}
    {% if prev_job_type == 'clinker_query' %}
        <b><p class="indent">Note that when your previous job was a clinker_query one, all cluster hits of the <a href="{{ url_for('result.show_result', job_id=main_search_id) }}">main search job</a> will be extracted.</p></b>
    {% endif %}
    <div class="input-layer centered">
        <input class="button" value="Submit" type="submit"/>
    </div>
</form>
        {% endblock %}
