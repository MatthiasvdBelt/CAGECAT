{% extends "base.xhtml" %}
{% from "macros.xhtml" import prev_session %}
{% from "macros.xhtml" import result_table %}


{% block title %}multicblaster{% endblock %}
{% block content %}

<!--Module buttons-->
<div class="modules">
    <button class="moduleSelector" onclick="showModule(event,
    'searchModuleContent')">Search
    </button>
    <button class="moduleSelector"
            onclick="showModule(event, 'gneModuleContent')">Neighbourhood
    </button>
    <button class="moduleSelector"
            onclick="showModule(event, 'extractModuleContent')">Extract
    </button>
</div>
<br/>

<!--Module contents-->
<div>

<div id="searchModuleContent" class="moduleContent">
<form method="post" enctype="multipart/form-data" action="{{submit_url}}"
      onsubmit="return validateForm()" name="searchOptionForm">
    <input type="hidden" name="job_type" value="search" required="required"/>

    <label for="inputSection">Input</label>
    <fieldset id="inputSection">

        <label>
        <input type="radio" value="fasta" checked="checked" id="radioFasta"
               name="inputType" onclick="showInputOptions('fasta')"/>FASTA</label>
        <label>
        <input type="radio" value="ncbi_entries" id="radioNCBIEntries"
               name="inputType"
               onclick="showInputOptions('ncbi_entries')"/>NCBI entries
        </label>
        <label>
        <input type="radio" value="prev_session" id="radioPrevSession"
               name="inputType"
                onclick="showInputOptions('prev_session')"/>Recompute
        </label>

    <div id="genomeFileUploadDiv">
        <label for="genomeFile">Query</label>
        <input type="file" id="genomeFile" name="genomeFiles"
               required="required"/>
    </div>
    <div id="ncbiEntriesDiv" style="display: none">
        <label for="ncbiEntriesTextArea">NCBI identifiers</label>
        <textarea rows="6" cols="25" id="ncbiEntriesTextArea"
                  name="ncbiEntriesTextArea"
                  placeholder="NCBI entry" disabled="disabled"></textarea>
    </div>
    {{ prev_session('search', false) }}

</fieldset>
    <br/>

    <label for="searchSection">Search</label>
<fieldset id="searchSection">
    <div>
        <label for="database_type">Database</label>
        <input type="text" required="required" name="database_type"
               id="database_type" value="nr"/>
    </div>
    <div>
        <label for="entrez_query">Entrez query</label>
        <input type="text" required="required" name="entrez_query"
               id="entrez_query" value="Aspergillus[organism]"/>
    </div>
    <div>
        <label for="max_hits">Maximum hits</label>
        <input type="number" required="required" name="max_hits"
               id="max_hits" min="1" step="1"
               value="5000"/>
    </div>
</fieldset>
    <br/>
    <label for="filteringSection">Filtering</label>
<fieldset id="filteringSection">
    <div>
        <label for="max_evalue">Max. e-value</label>
        <input type="number" required="required" value="0.01" step="0.01" id="max_evalue"
           name="max_evalue"/>
    </div>
    <div>
        <label for="min_identity">Min. identity (%)</label>
        <input type="number" required="required" value="30"
               id="min_identity" name="min_identity"/>
    </div>

    <div>
        <label for="min_query_coverage">Min. query coverage (%)</label>
        <input type="number" required="required" value="50" id="min_query_coverage"
               name="min_query_coverage"/>
    </div>

</fieldset>
<!--    <div>-->
<!--        <label for="option1">Option 1</label>-->
<!--        <input type="checkbox" id="option1" name="option1" checked="checked"/>-->

<!--    </div>-->
<!--    <div>-->
<!--        <label for="option2">Option 2</label>-->
<!--        <input type="checkbox" id="option2" name="option2" checked="checked"/>-->
<!--    </div>-->

<!--    <fieldset id="optionGroup1">-->
<!--        <legend>Options belonging together</legend>-->
<!--        <label for="option3">Option 3</label>-->
<!--        <input type="checkbox" id="option3" name="option3"/>-->

<!--        <label for="option4">Option 4</label>-->
<!--        <input type="checkbox" id="option4" name="option4" checked="checked"/>-->

<!--        <label for="option5">Option 5</label>-->
<!--        <input type="checkbox" id="option5" name="option5"-->
<!--               onclick="option5change()"/>-->
<!--    </fieldset>-->


<!--    <input type="number" id="e-value" name="e-value" value="0.005"-->
<!--           step="0.001" required="required"/>-->
    <br/>
    <label for="clusteringSection">Clustering</label>
    <fieldset id="clusteringSection">
        <div>
            <label for="max_intergenic_gap">Max. intergenic gap</label>
            <input type="number" id="max_intergenic_gap"
                   name="max_intergenic_gap" value="20000" step="1" required="required"/>
        </div>
        <div>
            <label for="min_unique_query_hits">Min. unique query hits</label>
            <input type="number" id="min_unique_query_hits"
                   name="min_unique_query_hits" value="3" step="1" min="0"
                   required="required"/>
        </div>
        <div>
            <label for="min_hits_in_clusters">Min. hits in clusters</label>
            <input type="number" id="min_hits_in_clusters"
                   name="min_hits_in_clusters" value="3" step="1" min="0" required="required"/>
        </div>

        <div>
            <input type="checkbox" id="requiredSequencesCheckbox"
                   name="requiredSequencesCheckbox"
                   onclick="toggleDisabled('requiredSequences')">Required sequences</input>
            <div id="requiredSequencesTextarea">
                <textarea rows="4" cols="25" name="requiredSequences"
                          id="requiredSequences" placeholder="NCBI entry"
                          disabled="disabled" required="required"></textarea>
            </div>
        </div>
    </fieldset>
    <br/>
    {{ result_table('search', "Sum") }}
    <br/>
    {{ result_table('search', "Bin") }}
    <br/>

    <label for="generalOptionSection">Additional options</label>
    <fieldset id="generalOptionSection">
        <input type="checkbox" id="sortClusters" name="sortClusters">Sort
            clusters
        </input>
        <input type="checkbox" id="generatePlot"
               name="generatePlot">Generate plot
        </input>
    </fieldset>

    <br/>
    <input type="submit" value="Run"/>

    </form>
</div>

<div id="gneModuleContent" class="moduleContent" style="display: none">
    <form method="post" enctype="multipart/form-data" action="{{submit_url}}"
          onsubmit="return validateForm()" name="gneOptionForm">

        <input type="hidden" name="job_type" value="gne" required="required"/>

        {{ prev_session('gne', true) }}
        <br/>

        {{ result_table('gne', 'Sum') }}
        <br/>
        <label for="gneOptions">Extra options</label>
        <fieldset id="gneOptions">
            <div>
                <label for="max_intergenic_distance">Max. intergenic distance</label>
                <input type="number" id="max_intergenic_distance" name="max_intergenic_distance" value="100000" required="required" step="1" min="0"/>
            </div>
            <div>
                <label for="sample_number">Number of samples</label>
                <input type="number" id="sample_number" name="sample_number" value="100" step="1" min="1" required="required"/>
            </div>
            <div>
                <label for="sampling_space">Sampling space</label>
                <select name="sampling_space" id="sampling_space" required="required">
                    <option name="spaceLinear" value="linear">linear</option>
                    <option name="spaceLog" value="log">log</option>
                </select>
            </div>
        </fieldset>

        <br/>
        <input type="submit" value="Run"/>
    </form>
</div>


<div id="extractModuleContent" class="moduleContent" style="display: none">
    <form method="post" enctype="multipart/form-data" action="{{submit_url}}"
          onsubmit="return validateForm()" name="extractOptionForm">
        <input type="hidden" name="job_type" value="extract"
               required="required"/>

        {{ prev_session('extract', true) }}
        <input type="submit" value="Run"/>
    </form>
</div>
</div>


{% endblock %}